"use strict";exports.id=523,exports.ids=[523],exports.modules={36523:(a,b,c)=>{c.r(b),c.d(b,{"401894aaf0ab5cf28dab637dc4383a12028c57509a":()=>j,"4020acb0d6d9f26a63a7d4627917e871401c6a2ba6":()=>h,"403c3c008f70040105381c5d8d2827def1094ea667":()=>g,"4043144e269d536e2e64051a103280cd82a4a10d67":()=>r,"404893bf97b07ebf64d6716928261741defdd6ca7b":()=>p,"40b0a2b1d0e9d777c929bc87dcd7a12099d4a2accc":()=>i,"40c835cc6ae521db1b06157424f9253366465a73f4":()=>q,"40f8b4e599bff4a3e4d2ab243ba5584af3daa2fd92":()=>l,"600814877ed82993dba55be2382cda5495a7188278":()=>m,"600898ea03f23dd7f393be36a0dcb6060d3fe019f6":()=>k,"6098798f65e7318f4246a123e5ada95d37fd14ff3e":()=>n,"609a060a124749eeff7f880772744cbd6a13c6c83e":()=>o});var d=c(91199);c(42087);var e=c(9128);function f(a,b){return/loop|tmpfs|squashfs|overlay|docker|snap|zram|ramfs|cgroup|fuse|run|devtmpfs|swap/i.test(a)||/swap|snap|loop|tmpfs|squashfs|overlay|docker|zram|ramfs|cgroup|fuse|run|devtmpfs/i.test(b)?"other":"primary"}async function g(a){try{let b=await (0,e.N)(a);return await b.dispose(),{success:!0,data:!0}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Connection failed"}}}async function h(a){try{let b=await (0,e.N)(a),{stdout:c}=await b.execCommand("free -m"),d=function(a){let b=a.split("\n"),[c,d,e,f,g,h,i]=b[1].split(/\s+/),[j,k,l,m]=b[2].split(/\s+/);return{unit:"MB",total:parseInt(d),used:parseInt(e),free:parseInt(f),shared:parseInt(g),buffers:parseInt(h),cached:parseInt(i),swapTotal:parseInt(k),swapUsed:parseInt(l),swapFree:parseInt(m),physical:{}}}(c),{stdout:f}=await b.execCommand("cat /proc/meminfo"),g=f.split("\n"),h={};return g.forEach(a=>{let[b,c]=a.split(":");b&&c&&(h[b.trim()]=c.trim())}),await b.dispose(),{success:!0,data:{...d,physical:h}}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed to get memory info"}}}async function i(a){try{let b=await (0,e.N)(a),{stdout:c}=await b.execCommand("lscpu"),d=function(a){let b=a.split("\n"),c={};return b.forEach(a=>{let[b,d]=a.split(":");b&&d&&(c[b.trim()]=d.trim())}),c}(c);return await b.dispose(),{success:!0,data:d}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed to get CPU info"}}}async function j(a){try{let b=await (0,e.N)(a),{stdout:c}=await b.execCommand("df -h"),d=function(a){let b=a.split("\n").slice(1).filter(a=>a.trim()).map(a=>{let[b,c,d,e,f,g]=a.split(/\s+/);return{fileSystem:b,size:c,used:d,available:e,use:f,mountedOn:g}});return{primary:b.filter(a=>"primary"===f(a.fileSystem,a.mountedOn)),others:b.filter(a=>"other"===f(a.fileSystem,a.mountedOn))}}(c);return await b.dispose(),{success:!0,data:d}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed to get disk info"}}}async function k(a,b){try{if(["rm","rmdir","mv","cp","dd","mkfs","fdisk"].some(a=>b.trim().startsWith(a)))return{success:!1,error:"Dangerous command not allowed"};let c=await (0,e.N)(a),d=await c.execCommand(b);return await c.dispose(),{success:!0,data:d}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Command execution failed"}}}async function l(a){try{let b=await (0,e.N)(a),{stdout:c,stderr:d}=await b.execCommand("dpkg -l"),f=[];return c&&!c.includes("command not found")?f=c.split("\n").slice(5).map(a=>a.trim().split(/\s+/)).filter(a=>a.length>=5&&"ii"===a[0]).map(a=>({name:a[1],version:a[2]})):({stdout:c,stderr:d}=await b.execCommand('rpm -qa --qf "%{NAME} %{VERSION}-%{RELEASE}\n"'),c&&!c.includes("command not found")&&(f=c.split("\n").map(a=>a.trim().split(" ")).filter(a=>a.length>=2).map(a=>({name:a[0],version:a[1]})))),await b.dispose(),{success:!0,data:f}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed to get packages info"}}}async function m(a,b){try{let c=await (0,e.N)(a),{stdout:d,stderr:f}=await c.execCommand(`sudo apt-get update && sudo apt-get install -y ${b}`);if(d&&!d.includes("command not found"))return await c.dispose(),{success:!0,data:d};if({stdout:d,stderr:f}=await c.execCommand(`sudo yum install -y ${b}`),await c.dispose(),d&&!d.includes("command not found"))return{success:!0,data:d};return{success:!1,error:f||"Failed to install package"}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed to install package"}}}async function n(a,b){try{let c=await (0,e.N)(a),{stdout:d,stderr:f}=await c.execCommand(`apt-cache search ^${b}$`);if(d&&!d.includes("command not found"))return await c.dispose(),{success:!0,data:d.trim().length>0};if({stdout:d,stderr:f}=await c.execCommand(`yum search ${b}`),await c.dispose(),d&&!d.includes("command not found"))return{success:!0,data:d.includes(b)};return{success:!1,error:f||"Failed to search for package"}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed to search for package"}}}async function o(a,b){try{let c=await (0,e.N)(a),{stdout:d,stderr:f}=await c.execCommand(`apt-cache search ${b}`),g=[];return d&&!d.includes("command not found")?g=d.split("\n").map(a=>a.split(" - ")[0].trim()).filter(a=>a.length>0).slice(0,5):({stdout:d,stderr:f}=await c.execCommand(`yum search ${b}`),d&&!d.includes("command not found")&&(g=d.split("\n").filter(a=>a.includes(" : ")).map(a=>a.split(" : ")[0].split(".")[0].trim()).filter(a=>a.length>0).slice(0,5))),await c.dispose(),{success:!0,data:g}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed to search for similar packages"}}}async function p(a){try{let b=await (0,e.N)(a),c=await b.execCommand('lscpu && top -bn1 | grep "Cpu(s)"'),d="--",f="--";if(c.stdout){let a=c.stdout.match(/CPU\(s\):\s+(\d+)/);f=a?a[1]:"--";let b=c.stdout.match(/Cpu\(s\):\s+([\d\.]+)\s+us/);d=b?b[1]+"%":"--%"}let g=await b.execCommand("free -m"),h="--",i="--",j="--";if(g.stdout){let a=g.stdout.split("\n").find(a=>a.toLowerCase().startsWith("mem:"));if(a){let b=a.split(/\s+/);i=b[1]+" MB",j=b[3]+" MB",h=(parseInt(b[2])||0)+" MB"}}let k=await b.execCommand("df -h --total | grep total"),l="--",m="--",n="--";if(k.stdout){let a=k.stdout.trim().split(/\s+/);a.length>=5&&(m=a[1],l=a[2],n=a[3])}let o=await b.execCommand("hostname -I | awk '{print $1}'"),p="--";o.stdout&&(p=o.stdout.trim().split(/\s+/)[0]);let q="--"!==p?"Online":"Offline",r=await b.execCommand("dpkg -l | grep ^ii | wc -l"),s=0;r.stdout&&(s=parseInt(r.stdout.trim())||0);let t=[];for(let a of["docker","python3","nodejs","nginx","mysql-server","postgresql"]){let c=await b.execCommand(`dpkg -l | grep ^ii | grep -w ${a}`);c.stdout&&c.stdout.includes(a)&&t.push(a)}let u=await b.execCommand("sudo ufw status"),v="--";u.stdout&&(v=u.stdout.includes("active")?"Active":"Inactive");let w=await b.execCommand("ss -tuln | awk '{print $5}' | grep ':' | awk -F: '{print $NF}' | sort | uniq | grep -E '^[0-9]+$' | tr '\n' ','"),x=[];return w.stdout&&(x=w.stdout.split(",").filter(Boolean)),await b.dispose(),{success:!0,data:{cpu:{usage:d,cores:f},memory:{usage:h,total:i,free:j},disk:{usage:l,total:m,free:n},network:{status:q,ip:p},software:{packageCount:s,keySoftware:t},security:{firewall:v,openPorts:x}}}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed to get dashboard overview"}}}async function q(a){try{let b=await (0,e.N)(a),c=await b.execCommand("ip -o -4 addr show | awk '{print $2, $4}'"),d=await b.execCommand("cat /proc/net/dev"),f=[];if(c.stdout&&d.stdout){let a=c.stdout.trim().split("\n"),b=d.stdout.trim().split("\n").slice(2);for(let c of a){let[a,d]=c.split(" "),e=b.find(b=>b.trim().startsWith(a+":")),g="--",h="--";if(e){let a=e.replace(":"," ").trim().split(/\s+/);g=a[1],h=a[9]}f.push({name:a,ip:d,rx:g,tx:h})}}let g=await b.execCommand("ss -tunap | tail -n +2"),h=[];if(g.stdout)for(let a of g.stdout.trim().split("\n")){let b=a.trim().split(/\s+/);b.length>=6&&h.push({proto:b[0],local:b[4],remote:b[5],state:b[1]})}return await b.dispose(),{success:!0,data:{interfaces:f,connections:h}}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed to get network info"}}}async function r(a){try{let b=await (0,e.N)(a),c="/etc/ssl/certs/ssl-cert-snakeoil.pem",d=await b.execCommand(`sudo openssl x509 -in ${c} -noout -text`);if(d.stderr&&d.stderr.includes("No such file")&&(c="/etc/ssl/certs/ssl-cert.pem",d=await b.execCommand(`sudo openssl x509 -in ${c} -noout -text`)),d.stderr&&d.stderr.includes("No such file"))return await b.dispose(),{success:!1,error:"No SSL certificate found in common locations."};let f=d.stdout||"",g=(f.match(/Subject: (.*)/)||[])[1]||"--",h=(f.match(/Issuer: (.*)/)||[])[1]||"--",i=(f.match(/Not Before: (.*)/)||[])[1]||"--",j=(f.match(/Not After : (.*)/)||[])[1]||"--",k=f.match(/X509v3 Subject Alternative Name:\s*(.*)/),l=[];return k&&k[1]&&(l=k[1].split(",").map(a=>a.trim())),await b.dispose(),{success:!0,data:{subject:g,issuer:h,validFrom:i,validTo:j,san:l}}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed to get SSL info"}}}(0,c(33331).D)([g,h,i,j,k,l,m,n,o,p,q,r]),(0,d.A)(g,"403c3c008f70040105381c5d8d2827def1094ea667",null),(0,d.A)(h,"4020acb0d6d9f26a63a7d4627917e871401c6a2ba6",null),(0,d.A)(i,"40b0a2b1d0e9d777c929bc87dcd7a12099d4a2accc",null),(0,d.A)(j,"401894aaf0ab5cf28dab637dc4383a12028c57509a",null),(0,d.A)(k,"600898ea03f23dd7f393be36a0dcb6060d3fe019f6",null),(0,d.A)(l,"40f8b4e599bff4a3e4d2ab243ba5584af3daa2fd92",null),(0,d.A)(m,"600814877ed82993dba55be2382cda5495a7188278",null),(0,d.A)(n,"6098798f65e7318f4246a123e5ada95d37fd14ff3e",null),(0,d.A)(o,"609a060a124749eeff7f880772744cbd6a13c6c83e",null),(0,d.A)(p,"404893bf97b07ebf64d6716928261741defdd6ca7b",null),(0,d.A)(q,"40c835cc6ae521db1b06157424f9253366465a73f4",null),(0,d.A)(r,"4043144e269d536e2e64051a103280cd82a4a10d67",null)}};